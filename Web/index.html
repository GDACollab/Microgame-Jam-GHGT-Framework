<!DOCTYPE html>
<html>
    <head>
        <title>Microgame Jam 2022</title>
        <link rel="stylesheet" href="stylesheet.css"/>
        <link rel="stylesheet" href="./jam-version-assets/version-style.css" id="version-style"/>

        <script src="lib/markdown-it.min.js"></script>
        <script>
            var ini;
            
            var markdown = window.markdownit({linkify: true});
            var defaultRender = markdown.renderer.rules.link_open || function(tokens, idx, options, env, self) {
               return self.renderToken(tokens, idx, options);
            };

            markdown.renderer.rules.link_open = function(tokens, idx, options, env, self) {
                var aIndex = tokens[idx].attrIndex("target");
                var bIndex = tokens[idx].attrIndex("tabindex");

                if (aIndex < 0) {
                    tokens[idx].attrPush(['target', '_blank']);
                } else {
                    tokens[idx].attrs[aIndex][1] = '_blank';
                }

                if (bIndex < 0) {
                    tokens[idx].attrPush(['tabindex', '-1']);
                } else {
                    tokens[idx].attrs[bIndex][1] = '-1';
                }

                return defaultRender(tokens, idx, options, env, self);
            }
        </script>
        <script src="gameinterface.js"></script>
        <script src="main.js" type="module"></script>
    </head>
    <body oncontextmenu="return false">
        <noscript>
            Your browser does not support Javascript. You need Javascript support to play GDA's Microgame Jam.
        </noscript>
        <div id="menu">
            <!-- Options require more fine control than config.ini can provide (config.ini is mostly used for setting up images and text for elementcreator.js to control), so I'm setting it up here entirely in HTML. -->
            <div id="options">
                <div id="other-options">
                    <div id="volume-control" style="position: relative; top: -100px;">
                        <p>Main Menu Volume</p>
                        <input id="options-volume" type="range" min="1" max="100"/>
                        <div class="googly-eye" id="options-volume-eye" scale="138">
                            <div class="googly-eye-center"></div>
                        </div>
                    </div>
                    <div id="remap-options">
                        <div id="remap-game-name">Game Name Here</div>
                        <div id="remap-game-up">
                            <p>Up (^) Alternate Bindings:</p>
                            <p><button></button></p>
                            <p><button>Clear</button></p>
                        </div>
                        <div id="remap-game-left">
                            <p>Left (<) Alternate Binding:</p>
                            <p><button></button></p>
                            <p><button>Clear</button></p>
                        </div>
                        <div id="remap-game-right">
                            <p>Right (>) Binding:</p>
                            <p><button></button></p>
                            <p><button>Clear</button></p>
                        </div>
                        <div id="remap-game-down">
                            <p>Down (v) Binding:</p>
                            <p><button></button></p>
                            <p><button>Clear</button></p>
                        </div>
                        <div id="remap-game-space">
                            <p>Space (_) Binding:</p>
                            <p><button></button></p>
                            <p><button>Clear</button></p>
                        </div>
                    </div>
                </div>
                <div id="options-select-games" style="position: relative; left: 460px; top: 967px; height: 83.3%; overflow-x: hidden; overflow-y: scroll;" onscroll="document.getElementById('options-select-games').scroll(0,0)">
                    <p style="border-left: 1px solid red; border-bottom: none; margin-left: 36px; padding-left: 10px; width: calc(100% - 33px); padding-top: 20px; padding-bottom: 20px;">
                        Microgame Settings
                    </p>
                </div>
            </div>
        </div>
        <div id="gameContainer">
            <div id="transitionContainer" hidden>
                <div id="winTransition" hidden></div>
                <div id="loseTransition" hidden></div>
                <div id="transitionLives"></div>
            </div>
            <div id="timer">
                <div id="timerEmpty" class="timerFill"></div>
                <div id="timerFull" class="timerFill"></div>
            </div>
            <!-- about:blank to avoid browser caches messing with us: -->
            <iframe id="game" src="about:blank" width="960px" height="540px" scrolling="no"></iframe>
            <!-- And as a double preventative measure courtesy of https://stackoverflow.com/questions/2648053/preventing-iframe-caching-in-browser -->
            <script>
                var _theframe = document.getElementById("game");
                _theframe.contentWindow.location.href = _theframe.src;
            </script>
        </div>
    </body>
</html>